!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.m=e,i.c=t,i.p="/",i(0)}([function(e,t,i){e.exports=i(12)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={black:"#000000",white:"#FFFFFF",green:"#00FF00",blue:"#0000FF",red:"#FF0000",lightBlue:"#33FFFF"}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.scale=1.25},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.g=t}return i(e,[{key:"centeredTexts",value:function(e,t,i,n,r){var s=this.g,o=.2*t,a=1===e.length?e[0].length:e.reduce(function(e,t){return e.length>t.length?e.length:t.length});return e.map(function(e,u){return s.text(e,t+"px monospace",i,s.stage.halfWidth-a/2*((t+o)/2),n+r*u)})}},{key:"centeredText",value:function(e,t,i,n){var r=.2*t,s=this.g;return s.text(e,t+"px monospace",i,s.stage.halfWidth-e.length/2*((t+r)/2),n)}}]),e}();t.default=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(i(5));var s=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.g=t,this.highlightFrames=null,this.drawKey(i,n),this.initSlime()}return n(e,[{key:"onCorrectNote",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.slime.jump(function(){e.slime.improveMood(),t()})}},{key:"onWrongNote",value:function(){var e=this;this.slime.shake(function(){e.slime.worsenMood()})}},{key:"getLabelY",value:function(){return this.sprite.y+this.getHeight()-20}},{key:"drawKey",value:function(e,t){this.sprite=this.g.rectangle(this.getWidth(),this.getHeight(),this.getFill(),this.getStroke(),2),this.sprite.x=this.getKeyX(e),this.sprite.y=this.getKeyY(),this.g.text(t,"16px monospace",this.getTextColor(),this.getLabelX(),this.getLabelY())}},{key:"initSlime",value:function(){this.slime=new r.default(this.g,this.sprite)}},{key:"highlight",value:function(e,t){this.sprite.fillStyle=e,t&&(this.highlightFrames=t*this.g.fps)}},{key:"update",value:function(){0===this.highlightFrames?(this.sprite.fillStyle=this.getFill(),this.highlightFrames=null):this.highlightFrames&&(this.highlightFrames-=1),this.slime.update()}}]),e}();t.default=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var n=t.HAPPY=1,r=t.NEUTRAL=0,s=t.SAD=-1,o=t.ANGRY=-2,a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.g=t,this.jumping=!1,this.mood=r,this.parentSprite=i,this.onDoneJumping=function(){},this.drawSprite()}return i(e,[{key:"setMood",value:function(e){this.mood=e,this.drawSprite()}},{key:"resetMood",value:function(){this.mood=r,this.drawSprite()}},{key:"improveMood",value:function(){this.mood!==o&&this.mood<n&&(this.mood++,this.drawSprite())}},{key:"worsenMood",value:function(){this.mood>o&&(this.mood--,this.drawSprite())}},{key:"drawSprite",value:function(){var e=void 0;switch(this.mood){case n:e="assets/happy-slime.png";break;case r:e="assets/neutral-slime.png";break;case s:e="assets/sad-slime.png";break;case o:e="assets/angry-slime.png";break;default:throw new Error("Unknown mood")}this.sprite?this.sprite.setTexture(e):this.sprite=this.g.sprite(e),this.parentSprite&&this.parentSprite.putTop(this.sprite),this.sprite.y-=3,this.sprite.scaleX=1.25,this.sprite.scaleY=1.25}},{key:"jump",value:function(e){this.onDoneJumping=e||function(){},this.jumping||this.falling||(this.jumping=!0,this.sprite.vy=-5,this.jumpFrames=.2*this.g.fps)}},{key:"shake",value:function(e){var t=this,i=8,n=1,r=function r(){t.sprite.x+=2*n,n*=-1,i>0?(i--,setTimeout(r,50)):e()};r()}},{key:"update",value:function(){this.jumping&&(0===this.jumpFrames?(this.jumping=!1,this.falling=!0,this.sprite.vy=10,this.fallFrames=.1*this.g.fps):this.jumpFrames-=1),this.falling&&(0===this.fallFrames?(this.falling=!1,this.sprite.vy=0,this.onDoneJumping()):this.fallFrames-=1),this.g.move(this.sprite)}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_WIDTH=void 0;var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=a(i(1)),s=a(i(4)),o=i(2);function a(e){return e&&e.__esModule?e:{default:e}}var u=t.KEY_WIDTH=80*o.scale,l=300*o.scale,h=function(e){function t(e,i,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),n(t,[{key:"getWidth",value:function(){return u}},{key:"getHeight",value:function(){return l}},{key:"getFill",value:function(){return r.default.white}},{key:"getStroke",value:function(){return r.default.black}},{key:"getKeyX",value:function(e){return 2+u*e}},{key:"getKeyY",value:function(){return 210}},{key:"getLabelX",value:function(){return this.sprite.x+42}},{key:"getTextColor",value:function(){return r.default.black}}]),t}();t.default=h},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var n=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.URL=window.URL||window.webkitURL,this.Blob=window.Blob,!this.URL||!this.Blob)throw new Error("This browser does not support AudioSynth");this._debug=!1,this._bitsPerSample=16,this._channels=1,this._sampleRate=44100,this._volume=32768,this._notes={C:261.63,"C#":277.18,D:293.66,"D#":311.13,E:329.63,F:349.23,"F#":369.99,G:392,"G#":415.3,A:440,"A#":466.16,B:493.88},this._fileCache=[],this._temp={},this._sounds=[],this._mod=[function(e,t,i,n){return Math.sin(2*Math.PI*(e/t)*i+n)}],this.__init__()}return i(e,[{key:"_pack",value:function(e,t){return[new Uint8Array([t,t>>8]),new Uint8Array([t,t>>8,t>>16,t>>24])][e]}},{key:"setSampleRate",value:function(e){return this._sampleRate=Math.max(Math.min(0|e,44100),4e3),this._clearCache(),this._sampleRate}},{key:"getSampleRate",value:function(){return this._sampleRate}},{key:"setVolume",value:function(e){return e=parseFloat(e),isNaN(e)&&(e=0),e=Math.round(32768*e),this._volume=Math.max(Math.min(0|e,32768),0),this._clearCache(),this._volume}},{key:"getVolume",value:function(){return Math.round(this._volume/32768*1e4)/1e4}},{key:"_resizeCache",value:function(){for(var e=this._fileCache,t=this._sounds.length;e.length<t;){for(var i=[],n=0;n<8;n++){var r={};for(var s in this._notes)r[s]={};i.push(r)}e.push(i)}}},{key:"_clearCache",value:function(){this._fileCache=[],this._resizeCache()}},{key:"generate",value:function(e,t,i,n){var r=this._sounds[e];if(!r)for(var s=0;s<this._sounds.length;s++)if(this._sounds[s].name==e){r=this._sounds[s],e=s;break}if(!r)throw new Error("Invalid sound or sound ID: "+e);(new Date).valueOf();this._temp={},i|=0,i=Math.min(8,Math.max(1,i));var o=n?parseFloat(n):2;if(void 0===this._notes[t])throw new Error(t+" is not a valid note.");if(void 0!==this._fileCache[e][i-1][t][o])return this._debug&&(new Date).valueOf(),this._fileCache[e][i-1][t][o];var a=this._notes[t]*Math.pow(2,i-4),u=this._sampleRate,l=this._volume,h=this._channels,c=this._bitsPerSample,f=r.attack(u,a,l),d=r.dampen(u,a,l),p=r.wave,v={modulate:this._mod,vars:this._temp},g=0,y=new Uint8Array(new ArrayBuffer(Math.ceil(u*o*2))),m=u*f|0,b=u*o|0;for(s=0;s!==m;s++)g=l*(s/(u*f))*p.call(v,s,u,a,l),y[s<<1]=g,y[1+(s<<1)]=g>>8;for(;s!==b;s++)g=l*Math.pow(1-(s-u*f)/(u*(o-f)),d)*p.call(v,s,u,a,l),y[s<<1]=g,y[1+(s<<1)]=g>>8;var w=["RIFF",this._pack(1,52),"WAVE","fmt ",this._pack(1,16),this._pack(0,1),this._pack(0,h),this._pack(1,u),this._pack(1,u*h*c/8),this._pack(0,h*c/8),this._pack(0,c),"data",this._pack(1,y.length*h*c/8),y],_=new this.Blob(w,{type:"audio/wav"}),k=this.URL.createObjectURL(_);return this._fileCache[e][i-1][t][o]=k,k}},{key:"play",value:function(e,t,i,n){var r=this.generate(e,t,i,n);return new Audio(r).play(),!0}},{key:"debug",value:function(){this._debug=!0}},{key:"listSounds",value:function(){for(var e=[],t=0;t<this._sounds.length;t++)e.push(this._sounds[t].name);return e}},{key:"__init__",value:function(){this._resizeCache()}},{key:"loadSoundProfile",value:function(){for(var e=0,t=arguments.length;e<t;e++){var i=arguments[e];if(!(i instanceof Object))throw new Error("Invalid sound profile.");this._sounds.push(i)}return this._resizeCache(),!0}},{key:"loadModulationFunction",value:function(){for(var e=0,t=arguments.length;e<t;e++){var i=arguments[e];if("function"!=typeof i)throw new Error("Invalid modulation function.");this._mod.push(i)}return!0}}]),e}();t.default=n},function(e,t){"use strict";function i(e){e.x+=0|e.vx,e.y+=0|e.vy}window.GA.custom=function(e){e.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.randomPick=function(t){return t[e.randomInt(0,t.length-1)]},e.move=function(e){if(e instanceof Array==!1)i(e);else for(var t=0;t<e.length;t++)i(e[t])}}},function(e,t){"use strict";var i=i||{};i.VERSION="0.0.1",i.plugins=void 0,i.custom=void 0,i.create=function(e,t,n,r,s){var o={};if(o.canvas=document.createElement("canvas"),o.canvas.setAttribute("width",1*e),o.canvas.setAttribute("height",1*t),o.canvas.style.backgroundColor="black",document.body.appendChild(o.canvas),o.canvas.ctx=o.canvas.getContext("2d"),o.stage=function(){var e={};return h(e),e.stage=!0,e.width=o.canvas.width,e.height=o.canvas.height,e.x=0,e.y=0,e.parent=void 0,e}(),o.key=function(){var e={};return e.leftArrow=c(37),e.upArrow=c(38),e.rightArrow=c(39),e.downArrow=c(40),e.space=c(32),e}(),o.buttons=[],o.dragAndDrop=!1,o.draggableSprites=[],o.tweens=[],o.state=void 0,o.load=s||void 0,o.setup=n||void 0,void 0===o.setup)throw new Error("Please supply the setup function in the constructor");function a(){if(requestAnimationFrame(a,o.canvas),void 0===o._fps)l(),o.render(o.canvas,0);else{var e=Date.now(),t=e-o._startTime;for(t>1e3&&(t=o._frameDuration),o._startTime=e,o._lag+=t;o._lag>=o._frameDuration;)u(),l(),o._lag-=o._frameDuration;var i=o._lag/o._frameDuration;o.render(o.canvas,i)}}function u(){o.stage.children.forEach(function(e){!function e(t){t._previousX=t.x;t._previousY=t.y;t.children&&t.children.length>0&&t.children.forEach(function(t){e(t)})}(e)})}function l(){if(o.buttons.length>0){o.canvas.style.cursor="auto";for(var e=o.buttons.length-1;e>=0;e--){var t=o.buttons[e];t.update(o.pointer,o.canvas),"over"!==t.state&&"down"!==t.state||t.stage||(o.canvas.style.cursor="pointer")}}if(o.state&&!o.paused&&o.state(),0!==o.updateFunctions.length)for(var i=0;i<o.updateFunctions.length;i++){(0,o.updateFunctions[i])()}}function h(e){e.x=0,e.y=0,e.vx=0,e.vy=0,e.width=0,e.height=0,e.scaleX=1,e.scaleY=1,e.pivotX=.5,e.pivotY=.5,e.rotation=0,e.visible=!0,e.parent=void 0,e.stage=!1,e.shadow=!1,e.shadowColor="rgba(100, 100, 100, 0.5)",e.shadowOffsetX=3,e.shadowOffsetY=3,e.shadowBlur=3,e.blendMode=void 0,e._alpha=1,e._draggable=void 0,e._layer=0,e._circular=!1,e._interactive=!1,e._previousX=void 0,e._previousY=void 0,e.children=[],e.addChild=function(t){t.parent&&t.parent.removeChild(t),t.parent=e,e.children.push(t)},e.removeChild=function(t){if(t.parent!==e)throw new Error(t+"is not a child of "+e);e.children.splice(e.children.indexOf(t),1)},e.add=function(t){var i=Array.prototype.slice.call(arguments);i.length>1?i.forEach(function(t){e.addChild(t)}):e.addChild(i[0])},e.remove=function(t){var i=Array.prototype.slice.call(arguments);i.length>1?i.forEach(function(t){e.removeChild(t)}):e.removeChild(i[0])},e.setPosition=function(t,i){e.x=t,e.y=i};var t=e;e.putTop=function(i,n,r){n=n||0,r=r||0,i.x=t.x+t.halfWidth-i.halfWidth+n,i.y=t.y-i.height+r,e.compensateForParentPosition(t,i)},e.compensateForParentPosition=function(e,t){0===t.parent.gx&&0===t.parent.gy||(t.x-=e.gx,t.y-=e.gy)},Object.defineProperties(e,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0},halfWidth:{get:function(){return e.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return e.height/2},enumerable:!0,configurable:!0}})}function c(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}return o.assetFilePaths=r||void 0,o.paused=!1,o._fps=60,o._startTime=Date.now(),o._frameDuration=1e3/o._fps,o._lag=0,o.interpolate=!0,o.updateFunctions=[],o.scale=1,o.start=function(){o.assetFilePaths?(o.assets.whenLoaded=function(){o.state=void 0,o.setup()},o.assets.load(o.assetFilePaths),o.load&&(o.state=o.load)):o.setup(),a()},o.pause=function(){o.paused=!0},o.resume=function(){o.paused=!1},Object.defineProperties(o,{fps:{get:function(){return o._fps},set:function(e){o._fps=e,o._startTime=Date.now(),o._frameDuration=1e3/o._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(e){o.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),o.remove=function(e){var t=Array.prototype.slice.call(arguments);if(t[0]instanceof Array){var i=t[0];if(i.length>0)for(var n=i.length-1;n>=0;n--){var r=i[n];r.parent.removeChild(r),i.splice(i.indexOf(r),1)}}else t.length>1?t.forEach(function(e){e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},o.rectangle=function(e,t,i,n,r,s,a){var u={};return h(u),u.mask=!1,u.width=e||32,u.height=t||32,u.fillStyle=i||"red",u.strokeStyle=n||"none",u.lineWidth=r||0,u.x=s||0,u.y=a||0,o.stage.addChild(u),u.render=function(e){e.strokeStyle=u.strokeStyle,e.lineWidth=u.lineWidth,e.fillStyle=u.fillStyle,e.beginPath(),e.rect(-u.width*u.pivotX,-u.height*u.pivotY,u.width,u.height),!0===u.mask?e.clip():("none"!==u.strokeStyle&&e.stroke(),"none"!==u.fillStyle&&e.fill())},u},o.text=function(e,t,i,n,r){var s={};return h(s),s.content=e||"Hello!",s.font=t||"12px sans-serif",s.fillStyle=i||"red",s.textBaseline="top",Object.defineProperties(s,{width:{get:function(){return o.canvas.ctx.measureText(s.content).width},enumerable:!0,configurable:!0},height:{get:function(){return o.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}}),o.stage.addChild(s),s.x=n||0,s.y=r||0,s.render=function(e){e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.fillStyle=s.fillStyle,0===s.width&&(s.width=e.measureText(s.content).width),0===s.height&&(s.height=e.measureText("M").width),e.translate(-s.width*s.pivotX,-s.height*s.pivotY),e.font=s.font,e.textBaseline=s.textBaseline,e.fillText(s.content,0,0)},s},o.sprite=function(e){var t={};if(void 0===e)throw new Error("Sprites require a source");return h(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=function(e){e.image||e instanceof Array||(t.tilesetFrame=o.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.x=0,t.y=0,o.stage.addChild(t),t.render=function(e){e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},o.image=function(e){return o.assets[e]},o.json=function(e){return o.assets[e]},o.render=function(e,t){var i=e.ctx;i.clearRect(0,0,e.width,e.height);for(var n=0;n<o.stage.children.length;n++){r(o.stage.children[n])}function r(n){if(n.visible&&n.gx<e.width+n.width&&n.gx+n.width>=-n.width&&n.gy<e.height+n.height&&n.gy+n.height>=-n.height){if(i.save(),o.interpolate?(void 0!==n._previousX?n.renderX=(n.x-n._previousX)*t+n._previousX:n.renderX=n.x,void 0!==n._previousY?n.renderY=(n.y-n._previousY)*t+n._previousY:n.renderY=n.y):(n.renderX=n.x,n.renderY=n.y),i.translate(n.renderX+n.width*n.pivotX,n.renderY+n.height*n.pivotY),i.globalAlpha=n.alpha,i.rotate(n.rotation),i.scale(n.scaleX,n.scaleY),n.blendMode&&(i.globalCompositeOperation=n.blendMode),n.render&&n.render(i),n.children&&n.children.length>0){i.translate(-n.width*n.pivotX,-n.height*n.pivotY);for(var s=0;s<n.children.length;s++){r(n.children[s])}}i.restore()}}},o.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif","webp"],whenLoaded:void 0,load:function(e){var t=this;t.toLoad=e.length,e.forEach(function(e){var i=e.split(".").pop();if(-1!==t.imageExtensions.indexOf(i)){var n=new Image;n.addEventListener("load",function(){n.name=e,t[n.name]={source:n,frame:{x:0,y:0,w:n.width,h:n.height}},t.loadHandler()},!1),n.src=e}})},loadHandler:function(){this.loaded+=1,this.toLoad===this.loaded&&(this.toLoad=0,this.loaded=0,this.whenLoaded())}},o.keyboard=c,o.makeDisplayObject=h,void 0!==i.plugins&&i.plugins(o),void 0!==i.custom&&i.custom(o),o},window.GA=i,window.ga=i.create},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OUT_OF_TUNE_PIANO=t.PIANO=void 0;var n=new(function(e){return e&&e.__esModule?e:{default:e}}(i(7)).default);n.loadModulationFunction(function(e,t,i,n){return 1*Math.sin(2*Math.PI*(e/t*i)+n)},function(e,t,i,n){return 1*Math.sin(4*Math.PI*(e/t*i)+n)},function(e,t,i,n){return 1*Math.sin(8*Math.PI*(e/t*i)+n)},function(e,t,i,n){return 1*Math.sin(.5*Math.PI*(e/t*i)+n)},function(e,t,i,n){return 1*Math.sin(.25*Math.PI*(e/t*i)+n)},function(e,t,i,n){return.5*Math.sin(2*Math.PI*(e/t*i)+n)},function(e,t,i,n){return.5*Math.sin(4*Math.PI*(e/t*i)+n)},function(e,t,i,n){return.5*Math.sin(8*Math.PI*(e/t*i)+n)},function(e,t,i,n){return.5*Math.sin(.5*Math.PI*(e/t*i)+n)},function(e,t,i,n){return.5*Math.sin(.25*Math.PI*(e/t*i)+n)});var r={name:"piano",attack:function(){return.002},dampen:function(e,t,i){return Math.pow(.5*Math.log(t*i/e),2)},wave:function(e,t,i,n){var r=this.modulate[0];return this.modulate[1](e,t,i,Math.pow(r(e,t,i,0),2)+.75*r(e,t,i,.25)+.1*r(e,t,i,.5))}},s=Object.assign({},r,{wave:function(e,t,i,n){var r=this.modulate[0];return this.modulate[1](e,t,.023*i,Math.pow(r(e,t,i,0),2)+.75*r(e,t,i,.25)+.1*r(e,t,i,.5))}});n.loadSoundProfile(r,s);t.PIANO=0,t.OUT_OF_TUNE_PIANO=1;t.default=n},function(e,t){"use strict";function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n=e.keyboard;return i(t={up:n(38),down:n(40),confirm:n(13),C4:n(65)},"C#4",n(87)),i(t,"D4",n(83)),i(t,"D#4",n(69)),i(t,"E4",n(68)),i(t,"F4",n(70)),i(t,"F#4",n(84)),i(t,"G4",n(71)),i(t,"G#4",n(89)),i(t,"A4",n(72)),i(t,"A#4",n(85)),i(t,"B4",n(74)),i(t,"C5",n(75)),t}},function(e,t,i){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(i(13)),r=i(2);i(9),i(8);var s=(0,window.ga)(644*r.scale,512*r.scale,function(){s.canvas.style.display="block",s.canvas.style.margin="auto",s.backgroundColor="white",s.state=(0,n.default)(s)},["assets/neutral-slime.png","assets/happy-slime.png","assets/sad-slime.png","assets/angry-slime.png"]);s.start()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(16)),r=s(i(15));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=new r.default(e),i=new n.default(e,t);return function(){i.update()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=u(i(4)),s=u(i(1)),o=i(6),a=i(2);function u(e){return e&&e.__esModule?e:{default:e}}var l=40*a.scale,h=200*a.scale,c=function(e){function t(e,i,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),n(t,[{key:"getWidth",value:function(){return l}},{key:"getHeight",value:function(){return h}},{key:"getFill",value:function(){return s.default.black}},{key:"getStroke",value:function(){return"#777777"}},{key:"getKeyX",value:function(e){var t=22+(l+o.KEY_WIDTH*e);return e>1&&(t+=o.KEY_WIDTH),t}},{key:"getKeyY",value:function(){return 210}},{key:"getLabelX",value:function(){return this.sprite.x+19}},{key:"getTextColor",value:function(){return s.default.white}}]),t}();t.default=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=o(i(3)),s=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.g=t,this.textUtil=new r.default(t)}return n(e,[{key:"setText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";this.text&&this.text.content===e&&this.subText&&this.subText.content===t||(this.text&&this.g.remove(this.text),this.text=this.textUtil.centeredText(e,24,s.default.black,0),this.subText&&this.subText.content===t||(this.subText&&this.g.remove(this.subText),this.subText=this.textUtil.centeredText(t,18,s.default.black,32)))}},{key:"setFooterText",value:function(e){this.footerText&&this.footerText.content===e||(this.footerText&&this.g.remove(this.footerText),this.footerText=this.textUtil.centeredText(e,18,s.default.black,this.g.stage.height-32))}}]),e}();t.default=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=p(i(11)),s=p(i(6)),o=p(i(14)),a=i(10),u=p(a),l=p(i(1)),h=p(i(3)),c=i(17),f=i(5),d=p(f);function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g=["C4","C#4","D4","D#4","E4","F4","F#4","G4","G#4","A4","A#4","B4","C5"],y=["A","W","S","E","D","F","T","G","Y","H","U","J","K"],m={};g.forEach(function(e,t){return m[e]=y[t]});var b=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.g=t,this.textUtil=new h.default(t),this.initControls(),this.createKeys(),this.initMidi(),this.waitForNote=!1,this.lockedInput=!1,this.onWinScreen=!1,this.started=!1,this.repeated=!1,this.hud=i,this.totalNotes=0,this.correctNotes=0,this.prevCorrectNotes=0,this.level=1,this.subLevel=1,this.showMenu(),this.resetScore()}return n(e,[{key:"resetScore",value:function(){var e;this.score=(v(e={},f.HAPPY,0),v(e,f.SAD,0),v(e,f.ANGRY,0),e),this.totalNotes=0,this.correctNotes=0}},{key:"initMidi",value:function(){var e=this;navigator.requestMIDIAccess&&navigator.requestMIDIAccess().then(function(t){var i=!0,n=!1,r=void 0;try{for(var s,o=t.inputs.values()[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){s.value.onmidimessage=function(t){if(159===t.data[0]&&t.data[1]>=60&&t.data[1]<73){var i=t.data[1]-60,n=g[i].match(/^(\D+)(\d)$/);e.playNoteAsPlayer(n[1],n[2])}}}}catch(e){n=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw r}}})}},{key:"showMenu",value:function(){this.hud.setText("Select Mode"),this.menuTexts=this.textUtil.centeredTexts(["Show All Notes  (Easier)","Show First Note (Harder)"],18,l.default.black,40,32),this.cursor=new d.default(this.g),this.cursor.setMood(f.HAPPY),this.cursor.sprite.y=this.menuTexts[0].y,this.cursor.sprite.x=this.menuTexts[0].x-24,this.selectedMode=0}},{key:"start",value:function(){this.started=!0,this.g.remove(this.menuTexts),this.g.remove(this.cursor.sprite),this.startTime=new Date,this.melodyLength=2,this.startRound(),this.hud.setFooterText("Level 1-1")}},{key:"reset",value:function(){this.g.remove(this.texts),this.g.remove(this.slimes.map(function(e){return e.sprite})),this.texts=[],this.slimes=[],this.started=!1,this.selectedMode=0,this.onWinScreen=!1,this.hud.setFooterText(" "),this.resetScore(),this.resetSlimes(),this.showSlimes(),this.showMenu()}},{key:"startRound",value:function(){this.hud.setText("Listen"),this.resetSlimes(),this.prevCorrectNotes=this.correctNotes,this.generateMelody()}},{key:"showResults",value:function(){var e=this,t=0;if(this.lockedInput=!0,Object.keys(this.keys).forEach(function(i){t+=e.keys[i].slime.mood,e.score[e.keys[i].slime.mood]++}),this.correctNotes-this.prevCorrectNotes===this.melodyLength)this.hud.setText("Perfect!");else if(0===t)this.hud.setText("Acceptable");else if(t>0)this.hud.setText("Nice!");else{this.hud.setText("Game Over",this.g.randomPick(["Slimes don't want to play anymore","Slimes have lost the music in their hearts","Slimes just remembered they have a thing","Slimes are kicking you out of the band"])),this.started=!1}t>=0&&(8===this.subLevel&&3===this.level?this.showWinScreen():(this.subLevel<8?this.subLevel++:(this.level++,this.subLevel=1),setTimeout(function(){e.startRound(),e.hud.setFooterText("Level "+e.level+"-"+e.subLevel)},2e3)))}},{key:"showWinScreen",value:function(){this.hud.setText("Winner!"),this.endTime=new Date,this.hideSlimes();var e=this.correctNotes/this.totalNotes*100,t=(this.endTime.getTime()-this.startTime.getTime())/1e3,i=Math.floor(t/60).toString(),n=(t%60).toFixed(3);this.texts=this.textUtil.centeredTexts([(0,c.rpad)("Mode",16)+(0===this.selectedMode?"All notes":"First note"),(0,c.rpad)("Correct Notes",16)+(e.toFixed(2)+"%"),(0,c.rpad)("Time",16)+((0,c.lpad)(i,2,"0")+":")+(0,c.lpad)(n,6,"0"),(0,c.lpad)(" ".toString(),16)+(0,c.lpad)(this.score[f.HAPPY].toString(),3),(0,c.lpad)(" ".toString(),16)+(0,c.lpad)(this.score[f.SAD].toString(),3),(0,c.lpad)(" ".toString(),16)+(0,c.lpad)(this.score[f.ANGRY].toString(),3)],18,l.default.black,32,24),this.slimes=[new d.default(this.g),new d.default(this.g),new d.default(this.g)],this.slimes[0].setMood(f.HAPPY),this.slimes[1].setMood(f.SAD),this.slimes[2].setMood(f.ANGRY);for(var r=0;r<3;r++)this.slimes[r].sprite.y=this.texts[r+3].y,this.slimes[r].sprite.x=this.texts[r+3].x+12;this.onWinScreen=!0}},{key:"toggleMode",value:function(){this.started||(0===this.selectedMode?this.selectedMode=1:this.selectedMode=0,this.cursor.sprite.x=this.menuTexts[this.selectedMode].x-24,this.cursor.sprite.y=this.menuTexts[this.selectedMode].y)}},{key:"initControls",value:function(){var e=this;this.controls=(0,r.default)(this.g),g.forEach(function(t){e.controls[t].press=function(){return e.playNoteAsPlayer(t.replace("4",""),t.charAt(t.length-1))}}),this.controls.C5.press=function(){return e.playNoteAsPlayer("C",5)},this.controls.confirm.press=function(){e.onWinScreen?e.reset():e.started?e.repeated||(e.playMelody(e.melody.slice()),e.repeated=!0):e.start()},this.controls.up.press=this.toggleMode.bind(this),this.controls.down.press=this.toggleMode.bind(this)}},{key:"endRoundIfMelodyOver",value:function(){return!this.lockedInput&&0===this.melody.length&&(this.lockedInput=!0,this.repeated=!1,this.showResults(),1===this.subLevel?this.melodyLength=2:this.melodyLength++,!0)}},{key:"playNoteAsPlayer",value:function(e,t){if(!this.lockedInput)if(this.waitForNote){if(this.waitForNote!==""+e+t)return;this.playNote(e,t,l.default.blue),this.waitForNote=!1,this.melody.shift(),this.endRoundIfMelodyOver()||this.hud.setText("Continue")}else if(this.melody&&this.melody.length){var i=this.keys[""+e+t];if(this.melody[0]===""+e+t)this.playNote(e,t,l.default.blue),this.melody.shift(),i.onCorrectNote(this.endRoundIfMelodyOver.bind(this)),this.correctNotes++,this.hud.setText("Play");else if(i.slime.mood!==f.ANGRY)this.waitForNote=this.melody[0],this.playNote(e,t,l.default.red,a.OUT_OF_TUNE_PIANO),this.keys[this.melody[0]].highlight(l.default.lightBlue),i.onWrongNote(),this.hud.setText("Play correct note to continue");else i.highlight(l.default.red,.25),this.hud.setText("Slime is angry","Play another key")}else this.waitForNote||this.playNote(e,t,l.default.blue)}},{key:"playNote",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.PIANO;u.default.play(n,e,t-1),i&&this.keys[""+e+t].highlight(i,.25)}},{key:"updateSlimes",value:function(e){var t=this;Object.keys(this.keys).forEach(function(i){e(t.keys[i].slime)})}},{key:"resetSlimes",value:function(){this.updateSlimes(function(e){return e.resetMood()})}},{key:"hideSlimes",value:function(){this.updateSlimes(function(e){return e.sprite.visible=!1})}},{key:"showSlimes",value:function(){this.updateSlimes(function(e){return e.sprite.visible=!0})}},{key:"generateMelody",value:function(){var e,t,i=this,n={1:(e={Pentatonic:[2,2,3,2]},v(e,"Whole Tone",[2,2,2,2,2]),v(e,"Blues",[3,2,1,1,3,2]),e),2:(t={Major:[2,2,1,2,2,2,1]},v(t,"Jazz Minor",[2,1,2,2,2,2,1]),v(t,"Harmonic Minor",[2,1,2,2,1,3,1]),t),3:{Diminished:[1,2,1,2,1,2,1,2],Chromatic:[1,1,1,1,1,1,1,1,1,1,1]}}[this.level],r=n[this.g.randomPick(Object.keys(n))],s={};g.forEach(function(e,t){"C5"!==e&&(s[e.replace("4","")]=function(e){var t=[e];return r.forEach(function(i,n){if(!(e>0&&n===r.length-1)){var s=t[t.length-1]+i;e>0&&(s%=12),t.push(s)}}),t}(t))});for(var o=this.g.randomPick(Object.keys(s)),a=s[o],u=g.filter(function(e,t){return a.indexOf(t)>-1}),l=[this.g.randomPick(u)],h=1;h<this.melodyLength;h+=1)l.length>1?function(){var e=l[l.length-1],t=l[l.length-2],n=Math.max(g.indexOf(e),g.indexOf(t))-Math.min(g.indexOf(e),g.indexOf(t)),r=u.filter(function(t,i){return i>u.indexOf(e)}),s=u.filter(function(t,i){return i<u.indexOf(e)}),o={};r.length&&(o.asc=r),s.length&&(o.desc=s);var a=i.g.randomPick(Object.keys(o)),h=o[a];n<5?l.push(i.g.randomPick(h)):"asc"===a?l.push(h[0]):l.push(h[h.length-1])}():l.push(this.g.randomPick(u.filter(function(e){return e!==l[0]})));this.melody=l.slice(),this.keys[l[0]].slime.setMood(f.HAPPY),this.playMelody(l),this.totalNotes+=this.melodyLength}},{key:"playMelody",value:function(e){var t=this;if(this.lockedInput=!0,e.length){var i=e.length===this.melodyLength,n=e.shift();(0===this.selectedMode||i)&&this.keys[n].slime.jump();var r=n.charAt(n.length-1),s=n.replace(/\d/,"");this.playNote(s,r,1!==this.selectedMode||i?l.default.lightBlue:null);var o=1e3-Math.min(80*this.melodyLength,800);window.setTimeout(function(){t.playMelody(e)},o)}else this.lockedInput=!1,this.repeated?this.hud.setText("Play"):this.hud.setText("Enter to repeat or start playing")}},{key:"createKeys",value:function(){var e=this;this.keys={},g.filter(function(e){return 2==e.length}).forEach(function(t,i){e.keys[t]=new s.default(e.g,i,m[t])}),g.filter(function(e){return 3===e.length}).forEach(function(t,i){e.keys[t]=new o.default(e.g,i,m[t])})}},{key:"update",value:function(){var e=this;Object.keys(this.keys).forEach(function(t){e.keys[t].update()})}}]),e}();t.default=b},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return Array(Math.max(0,e)).fill(t).join("")};t.rpad=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return e+i(t-e.length,n)},t.lpad=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return i(t-e.length,n)+e}}]);